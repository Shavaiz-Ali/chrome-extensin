const a=()=>{const e=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,{acceptNode:n=>{const o=n.textContent.trim().length>0,r=!["SCRIPT","STYLE"].includes(n.parentElement.tagName);return o&&r?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),t=[];let s;for(;s=e.nextNode();)t.push(s);return t},c=e=>{const t=document.createElement("span");return t.style.backgroundColor="#008000",t.style.color="#ffffff",t.style.border="1px solid #ffffff",e.parentNode.insertBefore(t,e),t.appendChild(e),t},d=async()=>{const e=await new Promise(n=>{chrome.storage.sync.get("translations",o=>{n(o.translations||{})})}),t=a(),s=[];t.forEach(n=>{const o=n.textContent.trim();if(!e[o]){const r=c(n);s.push({text:o,element:r})}}),chrome.runtime.sendMessage({action:"foundUntranslatedText",untranslatedTexts:s})};chrome.runtime.onMessage.addListener(e=>{e.action==="detectUntranslated"&&d()});
